---
name: tdd
description: テスト駆動開発ワークフローを強制する。インターフェースを足場に、まずテストを生成し、その後に最小実装で通す。80%+ カバレッジを保証。
disable-model-invocation: true
argument-hint: "[task-description]"
---

# TDD

**tdd-guide** エージェントを起動し、テスト駆動開発手法を徹底する。

## 行うこと

1. **インターフェースの足場作り** - 型/インターフェースを先に定義
2. **テストを先に生成** - 失敗するテストを書く（RED）
3. **最小実装** - 通る最小実装を書く（GREEN）
4. **リファクタ** - テストを緑のまま改善（REFACTOR）
5. **カバレッジ検証** - 80%+ を確保

## 使うタイミング

- 新機能の実装
- 新しい関数/コンポーネント追加
- バグ修正（再現テストを先に書く）
- 既存コードのリファクタ
- 重要なビジネスロジック

## TDD サイクル

```text
RED -> GREEN -> REFACTOR -> REPEAT

RED:      失敗するテストを書く
GREEN:    テストを通す最小実装を書く
REFACTOR: テストを保ったまま改善
REPEAT:   次の機能/シナリオへ
```

## 動作

tdd-guide エージェントは以下を行う:

1. 入出力の **インターフェース定義**
2. **失敗するテスト** を書く（コードがまだ無い）
3. **テスト実行** して失敗を確認
4. **最小実装** でテストを通す
5. **再度テスト** して通過を確認
6. **リファクタ** して品質改善
7. **カバレッジ** を確認し 80% 未満なら追加テスト

## ベストプラクティス

**DO:**
- 実装前に必ずテストを書く
- 実装前にテストが失敗することを確認
- 最小実装でテストを通す
- テストが緑の間にリファクタ
- エッジケースとエラーを追加
- 80%+ カバレッジ（重要コードは 100%）

**DON'T:**
- テストより先に実装を書く
- 変更後にテストを実行しない
- 一度に書きすぎる
- 失敗テストを放置
- 実装詳細をテストする（挙動をテスト）
- 何でもモックする（統合テストを優先）

## カバレッジ要件

- **最低 80%** 全体
- **100% 必須**:
  - 金融計算
  - 認証ロジック
  - セキュリティ重要コード
  - 主要ビジネスロジック

## 関連スキル

- 先に `/plan` で計画
- ビルドエラー時は `/build-fix`
- `/code-review` でレビュー
- `/test-coverage` でカバレッジ確認
