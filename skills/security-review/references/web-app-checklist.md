# Web App Security Checklist

## 1. Secrets

- ソースコードに秘密情報を埋め込まない
- 環境変数の存在チェックを実装する
- シークレットをログへ出力しない

## 2. Input Validation

- すべての外部入力を検証する
- スキーマベース（例: Zod）を優先する
- サイズ制限・型制限・許可リストを設定する

## 3. Authentication / Authorization

- 認証必須ルートを明示する
- リソースアクセスごとに認可を検証する
- 権限不足時は安全な失敗（403/404）を返す

## 4. Injection

- SQL は必ずパラメータ化する
- テンプレート/コマンド実行にユーザー入力を直結しない
- パス結合は正規化してディレクトリ外参照を防ぐ

## 5. Browser Security

- HTML を出力する箇所は XSS 対策する
- CSRF 防御（トークン/SameSite）を適用する
- セキュリティヘッダーを設定する（CSP など）

## 6. Abuse Protection

- 重要 API にレート制限を付与する
- 認証・決済系は監査ログを残す
- 失敗回数制限やロックを導入する

## 7. Error / Logging

- エラーに内部構造・秘密情報を含めない
- ログは PII の最小化とマスキングを行う
- セキュリティイベントを追跡可能にする

## 8. Dependencies

- 依存の脆弱性スキャンを定期実行する
- lockfile を必ずコミットする
- CI では再現可能インストール（`npm ci` 等）を使う

## 9. Pre-Release Gate

- 認証/認可
- 入力検証
- 注入対策
- XSS/CSRF
- レート制限
- シークレット管理
- ログ/監査
