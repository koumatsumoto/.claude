# ユーザーレベル CLAUDE.md

## 基本思想

あなたは Claude Code。私は複雑なタスクに特化エージェントやスキルを使う。

**主要原則:**

1. **Agent-First**: 複雑な作業は特化エージェントに委譲
2. **Parallel Execution**: 可能なら Task ツールで複数エージェントを並列実行
3. **Plan Before Execute**: 複雑な作業では Plan Mode
4. **Test-Driven**: 実装前にテスト
5. **Security-First**: セキュリティ妥協なし

---

## 作業ワークフロー

1. ユーザの指示を受ける
2. ユーザの指示に対して曖昧な点を質問して要求を詳細化する
3. 要求を深く理解したら作業計画を作成する
4. 作業計画が完成したらユーザーにレビューを求める
5. 承認後、作業を行う
6. 作業が完了したら作業内容のレビューをユーザに依頼する
7. git commit message 形式で作業結果を報告する

---

## モジュールルール

詳細ガイドラインは `rules/` にある:

| ルールファイル  | 内容                                                 |
| --------------- | ---------------------------------------------------- |
| security.md     | セキュリティチェック、シークレット管理               |
| coding-style.md | イミュータビリティ、ファイル構成、エラーハンドリング |
| testing.md      | TDD ワークフロー、80% カバレッジ要件                 |
| git-workflow.md | コミット形式、PR ワークフロー                        |
| agents.md       | エージェントの使い分け                               |
| patterns.md     | API レスポンス、リポジトリパターン                   |
| performance.md  | モデル選定、コンテキスト管理                         |

---

## 利用可能なエージェント

配置場所: `agents/`

| エージェント         | 目的                         |
| -------------------- | ---------------------------- |
| planner              | 実装計画                     |
| architect            | システム設計とアーキテクチャ |
| tdd-guide            | テスト駆動開発               |
| code-reviewer        | 品質/セキュリティレビュー    |
| security-reviewer    | 脆弱性分析                   |
| build-error-resolver | ビルドエラー解決             |
| e2e-runner           | Playwright E2E テスト        |
| refactor-cleaner     | デッドコード清掃             |
| doc-updater          | ドキュメント更新             |

---

## 個人設定

### コードスタイル

- コード、コメント、ドキュメントに絵文字禁止
- イミュータブルを優先（オブジェクト/配列をミューテーションしない）
- 大きなファイル少数より小さなファイル多数
- 200〜400 行が目安、最大 800 行/ファイル

### Git

Conventional Commits 形式に従う:

- プレフィックス: `feat:`, `fix:`, `docs:`, `style:`, `refactor:`, `test:`, `chore:`
- 件名は 50 文字以内、命令形で記述
- 形式: `type(scope): description`
- 3 行目以降に箇条書きで詳細説明を記載

コミットメッセージの詳細説明には以下の 3 項目を含める:

1. **作業指示内容**: ユーザーから受けた指示の要約。何を依頼されたか
2. **計画とその背景・理由**: 採用したアプローチとその理由。なぜこの方法を選んだか
3. **実際の作業内容**: 具体的に行った変更内容。何をどう変更したか

#### サンプル

```text
feat(monorepo): pnpm workspace とドキュメントのセットアップ

## 作業指示内容
- WBS.md に基づき、モノリポの初期セットアップを実施
- ドキュメントの移植と Prettier/Markdownlint の設定

## 作業計画と背景・理由
- pnpm workspace を採用し、効率的なモノリポ管理を実現
- printWidth=150 で既存プロジェクトとの整合性を保つ
- AGENTS.md を移植し、ガイドラインの一貫性を確保

## 実際の作業内容
- package.json, pnpm-workspace.yaml を作成
- .prettierrc, .markdownlint.json を設定
- docs/pj-tournament/ を ~/projects/api からコピー
- CLAUDE.md, AGENTS.md を作成
```

### テスト

- TDD: テストを先に書く
- 最低 80% カバレッジ
- 重要フローは Unit + Integration + E2E

---

## 成功指標

成功条件:

- 全テスト合格（80%+ カバレッジ）
- セキュリティ脆弱性なし
- コードが読みやすく保守しやすい
- ユーザー要件を満たす

---

**哲学**: Agent-first 設計、並列実行、行動前の計画、テスト先行、常にセキュリティ。
