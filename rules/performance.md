# パフォーマンス最適化

## モデル選定戦略

**Haiku 4.5**（Sonnet の 90% 能力で、コスト 1/3）:

- 軽量エージェントの頻繁な呼び出し
- ペアプログラミングやコード生成
- マルチエージェントのワーカー

**Sonnet 4.5**（最良のコーディングモデル）:

- メインの開発作業
- マルチエージェントワークフローのオーケストレーション
- 複雑なコーディングタスク

**Opus 4.5**（最深の推論）:

- 複雑なアーキテクチャ判断
- 最大限の推論が必要な場合
- 調査・分析タスク

## コンテキストウィンドウ管理

以下ではコンテキストウィンドウの最後の 20% を避ける:

- 大規模リファクタリング
- 複数ファイルにまたがる機能実装
- 複雑な相互作用のデバッグ

コンテキスト感度が低いタスク:

- 単一ファイル編集
- 独立したユーティリティ作成
- ドキュメント更新
- 単純なバグ修正

## Ultrathink + Plan Mode

深い推論が必要な複雑タスクでは:

1. `ultrathink` を使って思考を強化
2. **Plan Mode** を有効化して構造化
3. 複数回の批評で "エンジンを回す"
4. 役割分割のサブエージェントを使う

## ビルドのトラブルシューティング

ビルドが失敗した場合:

1. **build-error-resolver** エージェントを使う
2. エラーメッセージを分析
3. 段階的に修正
4. 各修正後に検証
